# CAP теорема, для чего она применяется

## 1. Что такое CAP-теорема

* **CAP-теорема (или теорема Брюэра)** — утверждает, что в распределённой системе невозможно одновременно гарантировать три свойства:

    1. **Consistency (согласованность)** — все узлы видят одни и те же данные в одно и то же время.
    2. **Availability (доступность)** — система всегда отвечает на запросы (даже если часть узлов недоступна).
    3. **Partition Tolerance (устойчивость к разделению сети)** — система продолжает работать даже при сбоях связи между узлами.

Формулировка: в распределённой системе можно выбрать **только два свойства из трёх**.

---

## 2. Для чего применяется CAP-теорема

* Для понимания **ограничений распределённых систем**.
* Для выбора подходящей архитектуры в зависимости от приоритетов:

    * Банковские системы — делают упор на **Consistency + Partition Tolerance (CP)**.
    * Системы поиска/кэширования — чаще выбирают **Availability + Partition Tolerance (AP)**.
* Для объяснения различий между NoSQL и реляционными БД в условиях распределения.
* Для проектирования микросервисной архитектуры и выбора хранилищ (например, Cassandra — AP, MongoDB можно настроить как CP или AP).

---

## 3. Классификация систем по CAP

1. **CP (Consistency + Partition tolerance)**

    * Жертвуют доступностью при сетевых сбоях.
    * Примеры: HBase, MongoDB (в строгом режиме).

2. **AP (Availability + Partition tolerance)**

    * Жертвуют строгой согласованностью, используют eventual consistency.
    * Примеры: Cassandra, DynamoDB, CouchDB.

3. **CA (Consistency + Availability)**

    * Возможны только в системах **без сетевых разделений** (теоретический случай).
    * Примеры: традиционные реляционные БД на одном сервере (PostgreSQL, MySQL в single-node).

---

## 4. Выжимка для собеседования

* **CAP-теорема**: в распределённой системе нельзя одновременно достичь Consistency, Availability и Partition tolerance.
* В реальности при сетевых сбоях всегда нужно выбирать между **C** и **A**.
* Типы систем:

    * **CP** — строгая согласованность, но могут быть недоступны (HBase, MongoDB).
    * **AP** — всегда доступны, но только eventual consistency (Cassandra, DynamoDB).
    * **CA** — только без распределения (Postgres в single-node).
* На собеседовании важно подчеркнуть: CAP помогает понять, **какие свойства жертвует система и почему**.
