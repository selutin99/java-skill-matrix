# –ö–æ–Ω—Ü–µ–ø—Ü–∏—è Zero Copy –∏ –∫–∞–∫ —ç—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É Kafka

## 1. –ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ zero-copy

–í —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ (–¥–∏—Å–∫–∞) –≤ —Å–µ—Ç—å –ø—É—Ç—å —Ç–∞–∫–æ–π:

1. –î–∞–Ω–Ω—ã–µ —á–∏—Ç–∞—é—Ç—Å—è **—Å –¥–∏—Å–∫–∞ –≤ kernel space (page cache)**.
2. –ö–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ **user space** (–±—É—Ñ–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Kafka).
3. –û—Ç—Ç—É–¥–∞ —Å–Ω–æ–≤–∞ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ **kernel space (socket buffer)**.
4. –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–æ —Å–µ—Ç–∏.

üëâ –¢–æ –µ—Å—Ç—å –º–∏–Ω–∏–º—É–º **–¥–≤–µ –ª–∏—à–Ω–∏–µ –∫–æ–ø–∏–∏** –º–µ–∂–¥—É –ø–∞–º—è—Ç—å—é —è–¥—Ä–∞ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º. –≠—Ç–æ:

* —Ä–∞—Å—Ö–æ–¥ CPU,
* –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Ä–∞–±–æ—Ç–∞,
* –±–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ GC –≤ JVM (–µ—Å–ª–∏ –±—É—Ñ–µ—Ä—ã –≤—ã–¥–µ–ª—è—é—Ç—Å—è –≤ heap).

---

## 2. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç Kafka —Å zero-copy

Kafka –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ **`sendfile()`** (Linux/Unix API).

–ü—Ä–∏ —ç—Ç–æ–º:

1. –î–∞–Ω–Ω—ã–µ —á–∏—Ç–∞—é—Ç—Å—è —Å –¥–∏—Å–∫–∞ –≤ **page cache —è–¥—Ä–∞**.
2. **–ë–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ user space** –Ω–∞–ø—Ä—è–º—É—é –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ —Å–µ—Ç–µ–≤–æ–π —Å–æ–∫–µ—Ç.

üìå –í –∏—Ç–æ–≥–µ Kafka –Ω–µ —Ç—Ä–∞—Ç–∏—Ç CPU –∏ –Ω–µ –∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ª–∏—à–Ω–∏–π —Ä–∞–∑.

---

## 3. –ü–æ—á–µ–º—É —ç—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç Kafka

* **–ú–µ–Ω—å—à–µ –∫–æ–ø–∏–π –¥–∞–Ω–Ω—ã—Ö** ‚Üí –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ CPU.
* **–û–±—Ö–æ–¥ JVM heap** ‚Üí –Ω–µ—Ç –º—É—Å–æ—Ä–∞ –¥–ª—è GC, –º–µ–Ω—å—à–µ –ø–∞—É–∑.
* **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å** (Kafka –º–æ–∂–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å **–≥–∏–≥–∞–±–∞–π—Ç—ã –≤ —Å–µ–∫—É–Ω–¥—É**).

---

## 4. –ì–¥–µ –∏–º–µ–Ω–Ω–æ Kafka –∏—Å–ø–æ–ª—å–∑—É–µ—Ç zero-copy

* –ö–æ–≥–¥–∞ –∫–æ–Ω—Å—é–º–µ—Ä –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —É –±—Ä–æ–∫–µ—Ä–∞.
* –ë—Ä–æ–∫–µ—Ä –¥–æ—Å—Ç–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–æ–≥-—Å–µ–≥–º–µ–Ω—Ç–æ–≤ (—Ñ–∞–π–ª–æ–≤ –Ω–∞ –¥–∏—Å–∫–µ) –∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `sendfile()` —à–ª—ë—Ç –∏—Ö –ø–æ —Å–µ—Ç–∏.
* –ü—Ä–æ–¥—é—Å–µ—Ä –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å –ø–∏—à–µ—Ç –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ –±—É—Ñ–µ—Ä–∏–∑—É—é—Ç—Å—è –≤ page cache –û–°.

---

## 5. –í—ã–∂–∏–º–∫–∞ –¥–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è

* **Zero-copy** ‚Äî —ç—Ç–æ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ —Å–µ—Ç–µ–≤–æ–π —Å–æ–∫–µ—Ç –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ user space.
* Kafka –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ **`sendfile()`**.
* –≠—Ç–æ –¥–∞—ë—Ç:
    * —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ CPU,
    * –º–µ–Ω—å—à–µ –∫–æ–ø–∏–π –≤ –ø–∞–º—è—Ç–∏,
    * –æ–±—Ö–æ–¥ JVM heap (–Ω–µ—Ç –ª–∏—à–Ω–µ–≥–æ GC),
    * –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.
* –ë–ª–∞–≥–æ–¥–∞—Ä—è zero-copy Kafka –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ **–æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è ‚Äú—Ç—Ä—É–±–∞‚Äù –¥–ª—è –¥–∞–Ω–Ω—ã—Ö**.
