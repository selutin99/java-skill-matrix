# Что такое контейнеры Docker, чем они отличаются от виртуальных машин, зачем нужен docker-compose

## 1. Что такое Docker-контейнеры

* **Контейнер** — это изолированная среда выполнения процесса, которая использует:

    * общее ядро ОС (Linux/Windows),
    * namespaces (изоляция процессов, сети, файловой системы),
    * cgroups (ограничения по ресурсам: CPU, память, диск).
* Контейнер запускает приложение вместе со всеми его зависимостями (библиотеки, конфиги), но без «полной» гостевой ОС.
* Docker — самая популярная реализация контейнеризации.

### Пример

```bash
docker run --rm -it ubuntu:22.04 bash
```

Запустит контейнер с Ubuntu-образом и откроет bash внутри.

---

## 2. Отличия контейнеров от виртуальных машин

| Характеристика    | Виртуальная машина (VM)                   | Контейнер (Docker)                        |
| ----------------- | ----------------------------------------- | ----------------------------------------- |
| Изоляция          | Полная ОС + гипервизор                    | Изоляция на уровне процессов (ядро общее) |
| Накладные расходы | Высокие (каждая VM = своя ОС)             | Минимальные (делят ядро)                  |
| Время запуска     | Секунды–минуты                            | Миллисекунды–секунды                      |
| Размер            | Гигабайты (диск + ОС)                     | Мегабайты (только зависимости)            |
| Use-case          | Полная эмуляция инфраструктуры, разные ОС | Микросервисы, быстрый CI/CD, dev среда    |

**Ключевое отличие**:

* ВМ — это виртуализированная железка + полноценная ОС.
* Контейнер — это процесс внутри хоста с лёгкой изоляцией.

---

## 3. Docker Compose

* Утилита для **описания и запуска нескольких контейнеров** как одного приложения.
* Использует **YAML-файл** (`docker-compose.yml`), где задаются:

    * сервисы (контейнеры),
    * сети,
    * тома (volumes),
    * переменные окружения.
* Удобно для разработки и тестов — поднимаем БД, кеш, сервисы одной командой.

### Пример `docker-compose.yml`

```yaml
version: '3.9'
services:
  app:
    build: .
    ports:
      - "8080:8080"
    depends_on:
      - db
  db:
    image: postgres:16
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
      POSTGRES_DB: mydb
    volumes:
      - db_data:/var/lib/postgresql/data

volumes:
  db_data:
```

### Запуск

```bash
docker-compose up -d   # поднять всё в фоне
docker-compose down    # остановить и удалить
```

---

## 4. Типичные сценарии

* Разработка микросервисов → приложение + Postgres + Redis.
* Тестирование → быстро поднять окружение с нужными версиями сервисов.
* CI/CD → сборка образа, запуск тестов в контейнерах.
* Локальная замена «кучи ручных установок» → один `docker-compose up`.

---

## 5. Выжимка для собеседования

* **Docker-контейнер** — изолированный процесс с зависимостями, использует общее ядро ОС, лёгкий и быстрый.
* **Отличие от VM**: ВМ = отдельная ОС, тяжёлые и медленные; контейнер = процесс, лёгкий, миллисекунды старта.
* **docker-compose** нужен для описания и запуска *многоконтейнерного окружения* (микросервисы, dev/test), декларативно через YAML.
* **Best practices**: минимальные образы (`alpine`), разделение build/run слоёв (multi-stage), хранение данных в volumes, использование сетей compose для сервисов.
