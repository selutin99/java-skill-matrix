# –ö–æ–Ω—Ü–µ–ø—Ü–∏—è service mesh, –∫–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –æ–Ω–∞ —Ä–µ—à–∞–µ—Ç –∏ –∫–∞–∫–∏–µ –µ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç istio

## 1. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è Service Mesh

* **Service Mesh** ‚Äî —ç—Ç–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π –±–µ—Ä—ë—Ç –Ω–∞ —Å–µ–±—è —Å–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏.
* –ò–¥–µ—è: –≤—ã–Ω–µ—Å—Ç–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é –∏–∑ –∫–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ **sidecar-–ø—Ä–æ–∫—Å–∏** (–æ–±—ã—á–Ω–æ Envoy).
* –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ø–∏—à–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É, –∞ mesh —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á–∏: –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å.

üëâ –û–±—ã—á–Ω–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –∫–∞–∫ **sidecar pattern**: —Ä—è–¥–æ–º —Å Pod –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ–∫—Å–∏ (Envoy), —á–µ—Ä–µ–∑ –Ω–µ–≥–æ –∏–¥—É—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã.

---

## 2. –ó–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–∞–µ—Ç service mesh

1. **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞**

    * –†–æ—É—Ç–∏–Ω–≥ –ø–æ –≤–µ—Ä—Å–∏—è–º (A/B, canary).
    * –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏.

2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

    * mTLS (–≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è –ø–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º).
    * –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ —Å–µ—Ç–µ–≤–æ–º —É—Ä–æ–≤–Ω–µ (RBAC).

3. **–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (observability)**

    * –ú–µ—Ç—Ä–∏–∫–∏ (latency, error rate, RPS).
    * –õ–æ–≥–∏ —Ç—Ä–∞—Ñ–∏–∫–∞.
    * –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ (traceId/SpanId –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∫–∏–¥—ã–≤–∞—é—Ç—Å—è).

4. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–æ–º**

    * –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ (rate limiting).
    * –†–µ—Ç—Ä–∞–∏, timeouts, circuit breaker.
    * Fault injection (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏).

5. **–ü–æ–ª–∏—Ç–∏–∫–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

    * Centralized policy enforcement.
    * –°–µ—Ç–µ–≤—ã–µ ACL –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤.

---

## 3. –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Service Mesh

* **Istio** ‚Äî —Å–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è (Envoy –∫–∞–∫ data plane).
* **Linkerd** ‚Äî –ª—ë–≥–∫–∞—è, —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (—Å–≤–æ–π –ø—Ä–æ–∫—Å–∏ –Ω–∞ Rust/Go).
* **Consul Connect** (HashiCorp) ‚Äî mesh –Ω–∞ –±–∞–∑–µ Consul.
* **Kuma** (–æ—Ç Kong) ‚Üí CNCF –ø—Ä–æ–µ–∫—Ç.
* **AWS App Mesh**, **Google Anthos Service Mesh**, **OpenShift Service Mesh** ‚Äî managed-—Ä–µ—à–µ–Ω–∏—è.

---

## 4. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Istio

### 4.1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

* **Data plane**: Envoy sidecar –≤ –∫–∞–∂–¥–æ–º Pod.
* **Control plane**: –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Istio, –∫–æ—Ç–æ—Ä—ã–µ —É–ø—Ä–∞–≤–ª—è—é—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π.

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

* **Pilot** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, —Å–µ—Ä–≤–∏—Å discovery.
* **Citadel** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –≤—ã–¥–∞—ë—Ç TLS-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è mTLS.
* **Mixer** (—É—Å—Ç–∞—Ä–µ–ª, —á–∞—Å—Ç—å –≤—ã–Ω–µ—Å–µ–Ω–∞) ‚Äî –ø–æ–ª–∏—Ç–∏–∫–∏ –∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è.
* **Istiod** (–≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç Pilot, Citadel, Galley).

### 4.2. –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. –ó–∞–ø—É—Å–∫–∞–µ–º Pod ‚Üí –∫ –Ω–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—á–µ—Ä–µ–∑ admission webhook) –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è Envoy sidecar.
2. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ Envoy.
3. Envoy –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç—Å—è control plane‚Äô–æ–º (Istiod).
4. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, —Ä–µ—Ç—Ä–∞–∏, TLS –∏ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### 4.3. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (Kubernetes)

**Deployment (app v1, v2):**

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp-v1
spec:
  replicas: 2
  template:
    metadata:
      labels:
        app: myapp
        version: v1
    spec:
      containers:
        - name: app
          image: myapp:1.0
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp-v2
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: myapp
        version: v2
    spec:
      containers:
        - name: app
          image: myapp:2.0
```

**VirtualService (–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è 90% ‚Üí v1, 10% ‚Üí v2):**

```yaml
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: myapp
spec:
  hosts:
    - myapp.default.svc.cluster.local
  http:
    - route:
        - destination:
            host: myapp.default.svc.cluster.local
            subset: v1
          weight: 90
        - destination:
            host: myapp.default.svc.cluster.local
            subset: v2
          weight: 10
```

**DestinationRule (–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–µ—Ä—Å–∏–∏):**

```yaml
apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: myapp
spec:
  host: myapp.default.svc.cluster.local
  subsets:
    - name: v1
      labels:
        version: v1
    - name: v2
      labels:
        version: v2
```

üëâ –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å **canary release –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**.

### 4.4. Observability –≤ Istio

* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∏ (Prometheus).
* Grafana –¥–∞—à–±–æ—Ä–¥—ã (latency, RPS, error rate).
* –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ (Jaeger/Tempo) —Å traceId –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
* Kiali ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è mesh-–≥—Ä–∞—Ñ–∞.

---

## 5. –í—ã–∂–∏–º–∫–∞ –¥–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è

* **Service Mesh** ‚Äî –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π –¥–ª—è —Å–µ—Ä–≤–∏—Å-2-—Å–µ—Ä–≤–∏—Å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π (–æ–±—ã—á–Ω–æ sidecar-–ø—Ä–æ–∫—Å–∏).
* **–†–µ—à–∞–µ—Ç –∑–∞–¥–∞—á–∏**: –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞, mTLS, –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (–º–µ—Ç—Ä–∏–∫–∏/–ª–æ–≥–∏/—Ç—Ä–µ–π—Å—ã), –ø–æ–ª–∏—Ç–∏–∫–∏ (ACL, rate limiting).
* **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: Istio (—Å–∞–º–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è), Linkerd (–ª—ë–≥–∫–∞—è), Consul Connect, Kuma, AWS App Mesh.
* **Istio**:

    * Data plane ‚Üí Envoy sidecar.
    * Control plane ‚Üí Istiod (Pilot + Citadel + –¥—Ä.).
    * –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏: canary/blue-green, retries, circuit breaking, fault injection, observability.
* **–ü—Ä–∏–º–µ—Ä**: VirtualService + DestinationRule ‚Üí —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–æ–º –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏ —Å–µ—Ä–≤–∏—Å–∞.
* **–ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è**: –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–Ω–∞–µ—Ç –æ mesh, –≤—Å—ë —Ä–µ—à–∞–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞.
