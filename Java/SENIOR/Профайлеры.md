# Когда нужно применять профайлеры, какие они бывают и как они влияют на работу приложения

## 1️⃣ Когда нужно применять профайлер

1. **Проблемы с производительностью**

    * Приложение медленно реагирует, долго обрабатывает запросы.
    * Не понятно, какие методы “тормозят”.

2. **Высокая нагрузка / масштабирование**

    * Нужно понять, какие участки кода создают узкие места (CPU-bound или I/O-bound).

3. **Проблемы с памятью**

    * Частые GC паузы, утечки памяти, OutOfMemoryError.
    * Профайлер помогает выявить, какие объекты остаются в памяти дольше времени жизни.

4. **Оптимизация алгоритмов и структуры данных**

    * Например, понять, что коллекция растёт слишком быстро или создаются лишние объекты.

---

## 2️⃣ Основные типы профайлеров

| Тип профайлера                     | Что измеряет                                                            | Примеры инструментов                             |
| ---------------------------------- | ----------------------------------------------------------------------- | ------------------------------------------------ |
| **CPU-профайлер**                  | Время выполнения методов, горячие участки кода                          | VisualVM, YourKit, JProfiler, Flight Recorder    |
| **Memory-профайлер**               | Потребление памяти, утечки, количество объектов                         | VisualVM, YourKit, Eclipse Memory Analyzer (MAT) |
| **Thread / Concurrency профайлер** | Заблокированные и ожидающие потоки, синхронизация                       | JVisualVM, YourKit, JFR                          |
| **I/O профайлер**                  | Время операций ввода-вывода, блокировки на файловых и сетевых операциях | JFR, async-profiler                              |
| **Allocation профайлер**           | Частота создания объектов, места аллокации                              | YourKit, async-profiler, Flight Recorder         |

---

## 3️⃣ Как профайлеры влияют на работу приложения

* **Нагрузка на CPU** — при активном профилировании приложение может работать медленнее (особенно при метод-профайлинге).
* **Использование памяти** — профайлеры могут удерживать ссылки на объекты для анализа, увеличивая потребление памяти.
* **Выбор профайлинга** — есть два подхода:

    1. **Sampling** (выборка) — легкий, низкое влияние на приложение, но менее точный.
    2. **Instrumentation** (инструментирование) — точный, замер каждого вызова метода, но сильнее замедляет работу.

---

## 4️⃣ Рекомендации

* Для **онлайн-приложений под нагрузкой** лучше начинать с **sampling**, чтобы минимально влиять на работу.
* Для **локальной оптимизации или тестирования** можно использовать **instrumentation** для точного анализа.
* Всегда анализировать **GC-логи вместе с профайлером**, чтобы видеть, как нагрузка на CPU и память связана с управлением памятью.
