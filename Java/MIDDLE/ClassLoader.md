# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤, ClassLoader

## **1. –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤**

Java –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ä–∞–∑—É –≤—Å–µ –∫–ª–∞—Å—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ **–∫–ª–∞—Å—Å—ã –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç—å –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏**:

* –∫–æ–≥–¥–∞ –≤—ã –≤–ø–µ—Ä–≤—ã–µ –æ–±—Ä–∞—â–∞–µ—Ç–µ—Å—å –∫ –∫–ª–∞—Å—Å—É,
* –ª–∏–±–æ —è–≤–Ω–æ —á–µ—Ä–µ–∑ API –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤ –∫–ª–∞—Å—Å–æ–≤ (class loaders).

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**

* –≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ (–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–ª–∞—Å—Å—ã).
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã **–≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã** (–ø–ª–∞–≥–∏–Ω—ã, hot reload).
* –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Tomcat –∏–∑–æ–ª–∏—Ä—É–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é —Ä–∞–∑–Ω—ã—Ö –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤).

---

## **2. –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞–≥—Ä—É–∑–∫–∞**

–ö–æ–≥–¥–∞ JVM –≤—Å—Ç—Ä–µ—á–∞–µ—Ç –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å, –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç—Ä–∏ —à–∞–≥–∞:

1. **Loading (–∑–∞–≥—Ä—É–∑–∫–∞)**
   –ö–ª–∞—Å—Å-—Ñ–∞–π–ª —Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–º (`ClassLoader`) –≤ –±–∞–π—Ç-–∫–æ–¥.
2. **Linking (—Å–≤—è–∑—ã–≤–∞–Ω–∏–µ)**

    * Verify ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –±–∞–π—Ç–∫–æ–¥–∞.
    * Prepare ‚Äî –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø–æ–¥ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
    * Resolve ‚Äî —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –Ω–∞ –¥—Ä—É–≥–∏–µ –∫–ª–∞—Å—Å—ã.
3. **Initialization (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è)**
   –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤ (`static { ... }`) –∏ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–ª—è–º.

---

## **3. –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ –∫–ª–∞—Å—Å–æ–≤ –≤ JVM**

–í Java –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ –æ–±—Ä–∞–∑—É—é—Ç **–∏–µ—Ä–∞—Ä—Ö–∏—é —Å –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º**: –µ—Å–ª–∏ –∫–ª–∞—Å—Å –Ω–µ –Ω–∞–π–¥–µ–Ω —É —Ä–æ–¥–∏—Ç–µ–ª—è, –∏—â–µ—Ç —Å–∞–º.

### **A. Bootstrap Class Loader**

* –ù–∞–ø–∏—Å–∞–Ω –Ω–∞ C, –≤—Å—Ç—Ä–æ–µ–Ω –≤ JVM.
* –ó–∞–≥—Ä—É–∂–∞–µ—Ç **–∫–ª–∞—Å—Å—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Java** (`rt.jar` –∏–ª–∏ `java.base` –≤ Java 9+).
* –≠—Ç–æ –Ω–µ –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ `ClassLoader`, –∞ —á–∞—Å—Ç—å JVM.

### **B. Platform (–∏–ª–∏ Extension) Class Loader**

* –ó–∞–≥—Ä—É–∂–∞–µ—Ç **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è Java** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–∑ `$JAVA_HOME/lib/ext` –≤ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –∏–ª–∏ –º–æ–¥—É–ª–∏ –≤ Java 9+).
* –í Java 9 –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ **Platform ClassLoader**.

### **C. Application (–∏–ª–∏ System) Class Loader**

* –ó–∞–≥—Ä—É–∂–∞–µ—Ç **–∫–ª–∞—Å—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ classpath** (`-cp` –∏–ª–∏ `CLASSPATH`).
* –≠—Ç–æ –æ–±—ã—á–Ω—ã–π –æ–±—ä–µ–∫—Ç Java (`sun.misc.Launcher$AppClassLoader` –∏–ª–∏ –µ–≥–æ –∞–Ω–∞–ª–æ–≥ –≤ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö).

---

## **4. –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ (Custom ClassLoaders)**

–í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –∑–∞–≥—Ä—É–∑—á–∏–∫, —á—Ç–æ–±—ã:

* –∑–∞–≥—Ä—É–∂–∞—Ç—å –∫–ª–∞—Å—Å—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Å–µ—Ç–∏, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö jar;
* —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏–ª–∏ –≥–æ—Ä—è—á—É—é –∑–∞–º–µ–Ω—É –∫–æ–¥–∞;
* –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å—ã —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–µ—Ä–≤–ª–µ—Ç-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö).

–ü—Ä–∏–º–µ—Ä:

```java
class MyClassLoader extends ClassLoader {
    @Override
    protected Class<?> findClass(String name) throws ClassNotFoundException {
        byte[] bytes = loadClassData(name); // —á–∏—Ç–∞–µ–º –±–∞–π—Ç—ã –æ—Ç–∫—É–¥–∞ —É–≥–æ–¥–Ω–æ
        return defineClass(name, bytes, 0, bytes.length);
    }
}
```

---

## **5. –ü—Ä–∏–Ω—Ü–∏–ø –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (Parent Delegation Model)**

* –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–ª–∞—Å—Å–∞ `ClassLoader` **—Å–Ω–∞—á–∞–ª–∞ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è**, –∑–∞–≥—Ä—É–∂–µ–Ω –ª–∏ –∫–ª–∞—Å—Å.
* –ï—Å–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—å –Ω–µ –Ω–∞—à—ë–ª, –∫–ª–∞—Å—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–∞–º.
* –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥–º–µ–Ω—É —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ (`java.lang.String`) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏.

**–ò—Å–∫–ª—é—á–µ–Ω–∏–µ:**
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ Tomcat, OSGi) **—á–∞—Å—Ç–∏—á–Ω–æ –Ω–∞—Ä—É—à–∞—é—Ç** —ç—Ç—É –º–æ–¥–µ–ª—å, —á—Ç–æ–±—ã –ø–æ–∑–≤–æ–ª–∏—Ç—å –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å–≤–æ–∏ –≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö.

---

## **6. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**

JVM –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –∫–ª–∞—Å—Å—ã —è–≤–Ω–æ:

```java
Class<?> cls = Class.forName("com.example.MyClass");
Object obj = cls.getDeclaredConstructor().newInstance();
```

–∏–ª–∏

```java
ClassLoader loader = Thread.currentThread().getContextClassLoader();
Class<?> cls = loader.loadClass("com.example.MyClass");
```

**–†–∞–∑–Ω–∏—Ü–∞:**

* `Class.forName()` —Å—Ä–∞–∑—É **–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç** –∫–ª–∞—Å—Å (–≤—ã–ø–æ–ª–Ω—è–µ—Ç static-–±–ª–æ–∫–∏).
* `loadClass()` —Ç–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç, –±–µ–∑ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Äî –¥–æ –ø–µ—Ä–≤–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è.

---

## **7. –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**

* **–°–µ—Ä–≤–ª–µ—Ç-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (Tomcat, Jetty)** ‚Äî –∏–∑–æ–ª–∏—Ä—É—é—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
* **Spring / Hibernate** ‚Äî –∑–∞–≥—Ä—É–∂–∞—é—Ç –∫–ª–∞—Å—Å—ã —á–µ—Ä–µ–∑ context class loader.
* **OSGi / JPMS (Java 9+)** ‚Äî –º–æ–¥—É–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã.
* **–ü–ª–∞–≥–∏–Ω—ã / —Å–∫—Ä–∏–ø—Ç—ã** ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π.

---

üìå **–ö—Ä–∞—Ç–∫–æ –¥–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è**

> –ö–ª–∞—Å—Å—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ –º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. 
> –ó–∞ —ç—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—è –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤: Bootstrap ‚Üí Platform ‚Üí Application. 
> –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî —Å–Ω–∞—á–∞–ª–∞ —Ä–æ–¥–∏—Ç–µ–ª—å, –ø–æ—Ç–æ–º —Å–≤–æ–π –∫–æ–¥. 
> –ö–ª–∞—Å—Å—ã –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —è–≤–Ω–æ —á–µ—Ä–µ–∑ `Class.forName()` –∏–ª–∏ `ClassLoader.loadClass()`, 
> –∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∏—Å–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤ –∏–ª–∏ –≥–æ—Ä—è—á–µ–π –ø–æ–¥–≥—Ä—É–∑–∫–∏ –∫–æ–¥–∞.
