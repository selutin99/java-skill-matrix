# 2. –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## üöÄ –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (Reactive Programming)

–û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π, –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö**, —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞:

* **Reactivity** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä–æ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–æ–±—ã—Ç–∏—è,
* **Resilience** ‚Äî —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—à–∏–±–∫–∞–º,
* **Elasticity** ‚Äî –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π,
* **Message-driven** ‚Äî –æ–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

–ë–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ **–ø–∞—Ç—Ç–µ—Ä–Ω–µ Observer** + **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å** + **–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ (streams)**.

---

## üîÑ –í —á—ë–º –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞?

| –ü–∞—Ä–∞–º–µ—Ç—Ä           | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥                      | –†–µ–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥                             |
| ------------------ | -------------------------------------- | --------------------------------------------- |
| –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞       | –ë–ª–æ–∫–∏—Ä—É—é—â–∏–π (`Thread.sleep`, `read()`) | –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π (`subscribe`, `onNext`)         |
| –ü–æ—Ç–æ–∫–∏             | –û–¥–∏–Ω –ø–æ—Ç–æ–∫ –Ω–∞ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å              | –û–¥–∏–Ω –ø–æ—Ç–æ–∫ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤              |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —á–∏—Å–ª–∞ –ø–æ—Ç–æ–∫–æ–≤               | –õ—É—á—à–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è, –º–µ–Ω—å—à–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç-—Å–≤–∏—Ç—á–µ–π |
| –ü–æ–¥—Ö–æ–¥             | –ò–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π                           | –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π (—á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π)        |

---

## ‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:

**–ü–æ–¥—Ö–æ–¥–∏—Ç:**

* –ú–Ω–æ–≥–æ I/O: HTTP, –±–∞–∑—ã, –æ—á–µ—Ä–µ–¥–∏.
* –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: —Ç—ã—Å—è—á–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
* –ü–æ—Ç–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ: WebSocket, SSE, Kafka.

**–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç:**

* CPU-bound –∑–∞–¥–∞—á–∏.
* –ü—Ä–æ—Å—Ç—ã–µ CRUD-—Å–µ—Ä–≤–∏—Å—ã.
* –ö–æ–º–∞–Ω–¥—ã –±–µ–∑ –¥–æ–ª–≥–∏—Ö –æ–∂–∏–¥–∞–Ω–∏–π.

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

* –ú–µ–Ω—å—à–µ –ø–æ—Ç–æ–∫–æ–≤ ‚Äî –≤—ã—à–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.
* –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π I/O ‚Äî –±—ã—Å—Ç—Ä–µ–µ –æ—Ç–∫–ª–∏–∫ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ.
* –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø–æ—Ç–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ backpressure.
* –•–æ—Ä–æ—à–∞—è —Å–æ—á–µ—Ç–∞–µ–º–æ—Å—Ç—å —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏, event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π.

---

## ‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:

* –°–ª–æ–∂–Ω–µ–µ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å.
* –¢—Ä–µ–±—É–µ—Ç "–≤—Å—ë –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–º" ‚Äî –æ—Ç –±–∞–∑—ã –¥–æ HTTP-–∫–ª–∏–µ–Ω—Ç–∞.
* –ë–æ–ª—å—à–µ boilerplate –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.
* –û–±—É—á–∞–µ–º–æ—Å—Ç—å –≤—ã—à–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤.

---

## üîÄ –¢–∏–ø—ã –ø–∞–±–ª–∏—à–µ—Ä–æ–≤ (–∏–∑ Project Reactor):

**1. `Mono<T>`**

* 0 –∏–ª–∏ 1 —ç–ª–µ–º–µ–Ω—Ç
* –ü—Ä–∏–º–µ—Ä: `Mono.just("OK")`, `Mono.empty()`

**2. `Flux<T>`**

* 0‚Ä¶N —ç–ª–µ–º–µ–Ω—Ç–æ–≤
* –ü—Ä–∏–º–µ—Ä: `Flux.fromIterable(list)`, `Flux.interval(Duration.ofSeconds(1))`

---

## üîÑ –ü—Ä–∏–º–µ—Ä –Ω–∞ Kotlin (Project Reactor):

```kotlin
fun getUser(id: String): Mono<User> = userRepo.findById(id)

fun getOrders(userId: String): Flux<Order> = orderRepo.findByUserId(userId)

getUser("123")
  .flatMapMany { user -> getOrders(user.id) }
  .subscribe { order -> println(order) }
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞–∂–Ω—ã–µ —Ç–µ–º—ã

### üßØ 1. Backpressure ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:** –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å (consumer) –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∏—Å—Ç–æ—á–Ω–∏–∫ (producer).

#### –†–µ—à–µ–Ω–∏—è –≤ Project Reactor:

* `onBackpressureBuffer()` ‚Äî —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ OOM).
* `onBackpressureDrop()` ‚Äî –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ª–∏—à–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã.
* `onBackpressureLatest()` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç.
* `limitRate(n)` ‚Äî –ø—Ä–æ—Å–∏—Ç –º–∞–∫—Å–∏–º—É–º `n` —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞ —Ä–∞–∑ (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞–º–∏).

> –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ **Reactive Streams** (pull-–º–æ–¥–µ–ª—å).

---

### üö® 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–û—à–∏–±–∫–∏ ‚Äî –æ–±—ã—á–Ω–∞—è —á–∞—Å—Ç—å —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.

#### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:

* `onErrorResume { ex -> fallbackMono }` ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –∑–∞–ø–∞—Å–Ω–æ–π –ø–æ—Ç–æ–∫.
* `onErrorReturn(defaultValue)` ‚Äî –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
* `retry(n)` ‚Äî –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É `n` —Ä–∞–∑.
* `doOnError { ex -> log.error("Error", ex) }` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ–±–æ—á–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç.
* `timeout(Duration.ofSeconds(3))` ‚Äî –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç `TimeoutException`, –µ—Å–ª–∏ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞.

#### –ü—Ä–∏–º–µ—Ä:

```kotlin
getUser(id)
  .onErrorResume { ex -> Mono.just(User("default")) }
```

---

### üîß 3. –û–ø–µ—Ä–∞—Ç–æ—Ä—ã —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏

–í–æ—Ç –∫—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä –∫–ª—é—á–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤:

| –û–ø–µ—Ä–∞—Ç–æ—Ä        | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                        |
| --------------- | ------------------------------------------------- |
| `map`           | –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ (1 –∫ 1)                   |
| `flatMap`       | –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ –Ω–æ–≤—ã–π `Mono`/`Flux`, "—Ä–∞—Å–ø–ª—é—â–∏–≤–∞–µ—Ç" |
| `filter`        | –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ —É—Å–ª–æ–≤–∏—é                    |
| `collectList`   | –°–æ–±–∏—Ä–∞—Ç—å `Flux<T>` –≤ `Mono<List<T>>`              |
| `concatWith`    | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø–æ—Ç–æ–∫–∏                 |
| `zipWith`       | –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–≤–∞ –ø–æ—Ç–æ–∫–∞ –ø–æ –ø–∞—Ä–∞–º                    |
| `take(n)`       | –ë–µ—Ä—ë—Ç –ø–µ—Ä–≤—ã–µ `n` —ç–ª–µ–º–µ–Ω—Ç–æ–≤                        |
| `delayElements` | –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏           |
